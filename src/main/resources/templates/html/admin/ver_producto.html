<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ver Productos | Administración</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/css/productos.css" />
  </head>
  <body>
    <div class="container-fluid py-4">
      <!-- Header -->
      <div class="row mb-4">
        <div class="col">
          <div class="d-flex justify-content-between align-items-center productos-header">
            <div>
              <h2 class="mb-1">
                <i class="bi bi-box-seam me-2"></i>
                Gestión de Productos
              </h2>
              <p class="mb-0">
                Administra tu inventario de productos
              </p>
            </div>
            <div class="productos-actions">
              <a href="/productos/nuevo" class="btn btn-primary">
                <i class="bi bi-plus-circle me-2"></i>
                Nuevo Producto
              </a>
              <a href="/admin/dashboard" class="btn btn-outline-secondary">
                <i class="bi bi-arrow-left me-2"></i>
                Volver al Dashboard
              </a>
            </div>
          </div>
        </div>
      </div>

      <!-- Productos Table -->
      <div class="card productos-card">
        <div class="card-header">
          <h5 class="mb-0">
            <i class="bi bi-list-ul me-2"></i>
            Lista de Productos
          </h5>
        </div>
        <div class="card-body p-0">
          <div class="table-responsive productos-table">
            <table class="table table-hover mb-0">
              <thead class="table-light">
                <tr>
                  <th scope="col">ID</th>
                  <th scope="col">Imagen</th>
                  <th scope="col">Nombre</th>
                  <th scope="col">Descripción</th>
                  <th scope="col">Tipo</th>
                  <th scope="col">Precio</th>
                  <th scope="col">Acciones</th>
                </tr>
              </thead>
              <tbody>
                <!-- Mensaje cuando no hay productos -->
                <tr th:if="${#lists.isEmpty(productos)}">
                  <td colspan="7" class="text-center py-5">
                    <div class="no-productos">
                      <i class="bi bi-inbox d-block mb-3"></i>
                      <h5>No hay productos registrados</h5>
                      <p class="mb-0">Comienza agregando tu primer producto</p>
                      <a href="/productos/nuevo" class="btn btn-primary mt-3">
                        <i class="bi bi-plus-circle me-2"></i>
                        Agregar Producto
                      </a>
                    </div>
                  </td>
                </tr>

                <!-- Lista de productos -->
                <tr
                  th:each="producto : ${productos}"
                  th:unless="${#lists.isEmpty(productos)}"
                >
                  <td class="fw-bold" th:text="${producto.id}">1</td>
                  <td>
                    <img
                      th:if="${producto.imagenUrl != null and producto.imagenUrl != ''}"
                      th:src="${producto.imagenUrl}"
                      th:alt="${producto.nombre}"
                      class="producto-imagen"
                    />
                    <div
                      th:unless="${producto.imagenUrl != null and producto.imagenUrl != ''}"
                      class="producto-imagen-placeholder"
                    >
                      <i class="bi bi-image"></i>
                    </div>
                  </td>
                  <td>
                    <div class="fw-bold" th:text="${producto.nombre}">
                      Nombre del producto
                    </div>
                  </td>
                  <td>
                    <div
                      class="text-muted small"
                      th:text="${producto.descripcion}"
                    >
                      Descripción del producto
                    </div>
                  </td>
                  <td>
                    <span
                      th:if="${producto.tipo == 'comida'}"
                      class="tipo-badge comida"
                      th:text="${producto.tipo}"
                      >comida</span
                    >
                    <span
                      th:if="${producto.tipo == 'bebida'}"
                      class="tipo-badge bebida"
                      th:text="${producto.tipo}"
                      >bebida</span
                    >
                    <span
                      th:if="${producto.tipo == 'frappes'}"
                      class="tipo-badge frappes"
                      th:text="${producto.tipo}"
                      >frappes</span
                    >
                    <span
                      th:unless="${producto.tipo == 'comida' or producto.tipo == 'bebida' or producto.tipo == 'frappes'}"
                      class="tipo-badge otro"
                      th:text="${producto.tipo}"
                      >otro</span
                    >
                  </td>
                  <td>
                    <span class="precio-badge"
                      >$<span th:text="${producto.precio}">0.00</span></span
                    >
                  </td>
                  <td>
                    <div class="acciones-buttons">
                      <a
                        th:href="@{/productos/editar/{id}(id=${producto.id})}"
                        class="btn btn-outline-primary btn-sm"
                        title="Editar"
                      >
                        <i class="bi bi-pencil"></i>
                      </a>
                      <button
                        type="button"
                        class="btn btn-outline-danger btn-sm"
                        title="Eliminar"
                        th:onclick="'confirmarEliminacion(' + ${producto.id} + ', \'' + ${producto.nombre} + '\')'"
                      >
                        <i class="bi bi-trash"></i>
                      </button>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal de confirmación de eliminación -->
    <div
      class="modal fade"
      id="modalEliminar"
      tabindex="-1"
      aria-labelledby="modalEliminarLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header border-0">
            <h5 class="modal-title" id="modalEliminarLabel">
              <i class="bi bi-exclamation-triangle text-warning me-2"></i>
              Confirmar Eliminación
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <p class="mb-3">
              ¿Estás seguro de que deseas eliminar el producto?
            </p>
            <div class="alert alert-warning border-0">
              <i class="bi bi-info-circle me-2"></i>
              <strong id="nombreProducto"></strong>
            </div>
            <p class="text-muted small mb-0">
              Esta acción no se puede deshacer.
            </p>
          </div>
          <div class="modal-footer border-0">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Cancelar
            </button>
            <a id="btnConfirmarEliminar" href="#" class="btn btn-danger">
              <i class="bi bi-trash me-2"></i>
              Sí, Eliminar
            </a>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      function confirmarEliminacion(id, nombre) {
        document.getElementById("nombreProducto").textContent = nombre;
        document.getElementById("btnConfirmarEliminar").href =
          "/productos/eliminar/" + id;
        new bootstrap.Modal(document.getElementById("modalEliminar")).show();
      }
    </script>
  </body>
</html>
